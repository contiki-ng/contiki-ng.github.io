<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Contiki-NG: Clock library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doc-style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Contiki-NG
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Clock library<div class="ingroups"><a class="el" href="group__timers.html">Timers</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>The clock library is the interface between Contiki and the platform specific clock functionality.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gae3ced0551b26c9b99cb45a86f34d100a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gae3ced0551b26c9b99cb45a86f34d100a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__clock.html#gae3ced0551b26c9b99cb45a86f34d100a">CLOCK_SECOND</a></td></tr>
<tr class="memdesc:gae3ced0551b26c9b99cb45a86f34d100a"><td class="mdescLeft">&#160;</td><td class="mdescRight">A second, measured in system clock time. <br/></td></tr>
<tr class="separator:gae3ced0551b26c9b99cb45a86f34d100a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga78ab77b57cf2e00089f0a3a22508524c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__clock.html#ga78ab77b57cf2e00089f0a3a22508524c">clock_init</a> (void)</td></tr>
<tr class="memdesc:ga78ab77b57cf2e00089f0a3a22508524c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the clock library.  <a href="#ga78ab77b57cf2e00089f0a3a22508524c">More...</a><br/></td></tr>
<tr class="separator:ga78ab77b57cf2e00089f0a3a22508524c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga50c22f9b9d60dd1f9e59b63a3a6676b1"><td class="memItemLeft" align="right" valign="top">CCIF clock_time_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__clock.html#ga50c22f9b9d60dd1f9e59b63a3a6676b1">clock_time</a> (void)</td></tr>
<tr class="memdesc:ga50c22f9b9d60dd1f9e59b63a3a6676b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current clock time.  <a href="#ga50c22f9b9d60dd1f9e59b63a3a6676b1">More...</a><br/></td></tr>
<tr class="separator:ga50c22f9b9d60dd1f9e59b63a3a6676b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8bbd5d5a773349139eee79d365af36ab"><td class="memItemLeft" align="right" valign="top">CCIF unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__clock.html#ga8bbd5d5a773349139eee79d365af36ab">clock_seconds</a> (void)</td></tr>
<tr class="memdesc:ga8bbd5d5a773349139eee79d365af36ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current value of the platform seconds.  <a href="#ga8bbd5d5a773349139eee79d365af36ab">More...</a><br/></td></tr>
<tr class="separator:ga8bbd5d5a773349139eee79d365af36ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga06b67aefbb407a877fc4b9cc9e6b70a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__clock.html#ga06b67aefbb407a877fc4b9cc9e6b70a8">clock_set_seconds</a> (unsigned long sec)</td></tr>
<tr class="memdesc:ga06b67aefbb407a877fc4b9cc9e6b70a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the value of the platform seconds.  <a href="#ga06b67aefbb407a877fc4b9cc9e6b70a8">More...</a><br/></td></tr>
<tr class="separator:ga06b67aefbb407a877fc4b9cc9e6b70a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga82ef3aca786cc000eeece4a7d036b238"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__clock.html#ga82ef3aca786cc000eeece4a7d036b238">clock_wait</a> (clock_time_t t)</td></tr>
<tr class="memdesc:ga82ef3aca786cc000eeece4a7d036b238"><td class="mdescLeft">&#160;</td><td class="mdescRight">Wait for a given number of ticks.  <a href="#ga82ef3aca786cc000eeece4a7d036b238">More...</a><br/></td></tr>
<tr class="separator:ga82ef3aca786cc000eeece4a7d036b238"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac0603df16193735b2cf4b70d54133356"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__clock.html#gac0603df16193735b2cf4b70d54133356">clock_delay_usec</a> (uint16_t dt)</td></tr>
<tr class="memdesc:gac0603df16193735b2cf4b70d54133356"><td class="mdescLeft">&#160;</td><td class="mdescRight">Delay a given number of microseconds.  <a href="#gac0603df16193735b2cf4b70d54133356">More...</a><br/></td></tr>
<tr class="separator:gac0603df16193735b2cf4b70d54133356"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae57f21c49f465372a8bf2ac3fbe03ba8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gae57f21c49f465372a8bf2ac3fbe03ba8"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__clock.html#gae57f21c49f465372a8bf2ac3fbe03ba8">clock_fine_max</a> (void)</td></tr>
<tr class="memdesc:gae57f21c49f465372a8bf2ac3fbe03ba8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deprecated platform-specific routines. <br/></td></tr>
<tr class="separator:gae57f21c49f465372a8bf2ac3fbe03ba8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab39f034abde9b75800698e459e43c3db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__clock.html#gab39f034abde9b75800698e459e43c3db">clock_delay</a> (unsigned int delay)</td></tr>
<tr class="memdesc:gab39f034abde9b75800698e459e43c3db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Obsolete delay function but we implement it here since some code still uses it.  <a href="#gab39f034abde9b75800698e459e43c3db">More...</a><br/></td></tr>
<tr class="separator:gab39f034abde9b75800698e459e43c3db"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>The clock library is the interface between Contiki and the platform specific clock functionality. </p>
<p>The clock library defines a macro, CLOCK_SECOND, to convert seconds into the tick resolution of the platform. Typically this is 1-10 milliseconds, e.g. 4*CLOCK_SECOND could be 512. A 16 bit counter would thus overflow every 1-10 minutes. Platforms use the tick interrupt to maintain a long term count of seconds since startup.</p>
<p>Platforms may also implement rtimers for greater time resolution and for real-time interrupts, These use a corresponding RTIMER_SECOND.</p>
<dl class="section note"><dt>Note</dt><dd>These timers do not necessarily have a common divisor or are phase locked. One may be crystal controlled and the other may not. Low power operation or sleep will often use one for wake and disable the other, then give it a tick correction after wakeup.</dd>
<dd>
The clock library need in many cases not be used directly. Rather, the <a class="el" href="group__timer.html">timer library</a>, <a class="el" href="group__etimer.html">event timers</a>, or <a class="el" href="structrtimer.html">rtimer library</a> should be used.</dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group__timer.html">Timer library</a> </dd>
<dd>
<a class="el" href="group__etimer.html">Event timers</a> </dd>
<dd>
<a class="el" href="structrtimer.html">Realtime library</a> </dd></dl>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gab39f034abde9b75800698e459e43c3db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clock_delay </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>dt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Obsolete delay function but we implement it here since some code still uses it. </p>
<p>Obsolete delay function but we implement it here since some code still uses it. </p>

<p>Definition at line <a class="el" href="cpu_2cc2538_2clock_8c_source.html#l00164">164</a> of file <a class="el" href="cpu_2cc2538_2clock_8c_source.html">clock.c</a>.</p>

<p>References <a class="el" href="cpu_2cc2538_2clock_8c_source.html#l00150">clock_delay_usec()</a>, and <a class="el" href="cpu_2cc2538_2dev_2watchdog_8c_source.html#l00085">watchdog_periodic()</a>.</p>

<p>Referenced by <a class="el" href="leds_8c_source.html#l00079">leds_blink()</a>.</p>

</div>
</div>
<a class="anchor" id="gac0603df16193735b2cf4b70d54133356"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clock_delay_usec </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>dt</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Delay a given number of microseconds. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dt</td><td>How many microseconds to delay.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Interrupts could increase the delay by a variable amount.</dd></dl>
<p>Delay a given number of microseconds. </p>

<p>Definition at line <a class="el" href="cpu_2cc2538_2clock_8c_source.html#l00150">150</a> of file <a class="el" href="cpu_2cc2538_2clock_8c_source.html">clock.c</a>.</p>

<p>References <a class="el" href="gptimer_8h_source.html#l00049">GPT_0_BASE</a>, <a class="el" href="gptimer_8h_source.html#l00061">GPTIMER_CTL</a>, <a class="el" href="gptimer_8h_source.html#l00149">GPTIMER_CTL_TAEN</a>, and <a class="el" href="gptimer_8h_source.html#l00067">GPTIMER_TAILR</a>.</p>

<p>Referenced by <a class="el" href="cpu_2cc2538_2clock_8c_source.html#l00164">clock_delay()</a>, <a class="el" href="cpu_2cc2538_2dev_2i2c_8c_source.html#l00049">i2c_init()</a>, <a class="el" href="cpu_2cc2538_2dev_2i2c_8c_source.html#l00133">i2c_master_command()</a>, <a class="el" href="mp3-wtv020sd_8c_source.html#l00173">mp3_wtv020sd_gpio_next()</a>, <a class="el" href="mp3-wtv020sd_8c_source.html#l00198">mp3_wtv020sd_reset()</a>, <a class="el" href="remote-revb_2power-mgmt_8c_source.html#l00250">pm_get_voltage()</a>, <a class="el" href="remote-revb_2power-mgmt_8c_source.html#l00128">pm_reset_system()</a>, and <a class="el" href="rtcc_8c_source.html#l00744">rtcc_set_autocalibration()</a>.</p>

</div>
</div>
<a class="anchor" id="ga78ab77b57cf2e00089f0a3a22508524c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clock_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the clock library. </p>
<p>This function initializes the clock library and should be called from the <a class="el" href="group__cc2538.html#ga840291bc02cba5474a4cb46a9b9566fe" title="Main routine for the cc2538dk platform. ">main()</a> function of the system.</p>
<p>Initialize the clock library.</p>
<p>We initialise the SysTick to fire 128 interrupts per second, giving us a value of 128 for CLOCK_SECOND</p>
<p>We also initialise GPT0:Timer A, which is used by <a class="el" href="group__clock.html#gac0603df16193735b2cf4b70d54133356" title="Delay a given number of microseconds. ">clock_delay_usec()</a>. We use 16-bit range (individual), count-down, one-shot, no interrupts. The prescaler is computed according to the system clock in order to get 1 tick per usec. </p>

<p>Definition at line <a class="el" href="cpu_2cc2538_2clock_8c_source.html#l00093">93</a> of file <a class="el" href="cpu_2cc2538_2clock_8c_source.html">clock.c</a>.</p>

<p>References <a class="el" href="gptimer_8h_source.html#l00049">GPT_0_BASE</a>, <a class="el" href="gptimer_8h_source.html#l00058">GPTIMER_CFG</a>, <a class="el" href="gptimer_8h_source.html#l00061">GPTIMER_CTL</a>, <a class="el" href="gptimer_8h_source.html#l00059">GPTIMER_TAMR</a>, <a class="el" href="gptimer_8h_source.html#l00071">GPTIMER_TAPR</a>, <a class="el" href="cpu_2nrf52832_2dev_2clock_8c_source.html#l00082">lfclk_config()</a>, <a class="el" href="cpu_2nrf52832_2dev_2clock_8c_source.html#l00095">rtc_config()</a>, <a class="el" href="sys-ctrl_8h_source.html#l00067">SYS_CTRL_RCGCGPT</a>, <a class="el" href="sys-ctrl_8h_source.html#l00139">SYS_CTRL_RCGCGPT_GPT0</a>, and <a class="el" href="core__cm0_8h_source.html#l00782">SysTick_Config()</a>.</p>

<p>Referenced by <a class="el" href="cc2538dk_2contiki-main_8c_source.html#l00142">main()</a>.</p>

</div>
</div>
<a class="anchor" id="ga8bbd5d5a773349139eee79d365af36ab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CCIF unsigned long clock_seconds </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the current value of the platform seconds. </p>
<p>This could be the number of seconds since startup, or since a standard epoch.</p>
<dl class="section return"><dt>Returns</dt><dd>The value. </dd></dl>

<p>Definition at line <a class="el" href="cpu_2cc2538_2clock_8c_source.html#l00130">130</a> of file <a class="el" href="cpu_2cc2538_2clock_8c_source.html">clock.c</a>.</p>

<p>References <a class="el" href="clock_8h_source.html#l00082">CLOCK_SECOND</a>, and <a class="el" href="cpu_2cc2538_2clock_8c_source.html#l00118">clock_time()</a>.</p>

<p>Referenced by <a class="el" href="resolv_8c_source.html#l00754">newdata()</a>, <a class="el" href="resolv_8c_source.html#l01312">resolv_lookup()</a>, <a class="el" href="resolv_8c_source.html#l01233">resolv_query()</a>, <a class="el" href="stimer_8c_source.html#l00156">stimer_elapsed()</a>, <a class="el" href="stimer_8c_source.html#l00124">stimer_expired()</a>, <a class="el" href="stimer_8c_source.html#l00140">stimer_remaining()</a>, <a class="el" href="stimer_8c_source.html#l00107">stimer_restart()</a>, <a class="el" href="stimer_8c_source.html#l00067">stimer_set()</a>, and <a class="el" href="uip-nameserver_8c_source.html#l00095">uip_nameserver_update()</a>.</p>

</div>
</div>
<a class="anchor" id="ga06b67aefbb407a877fc4b9cc9e6b70a8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clock_set_seconds </td>
          <td>(</td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>sec</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the value of the platform seconds. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sec</td><td>The value to set. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="cpu_2cc2538_2clock_8c_source.html#l00124">124</a> of file <a class="el" href="cpu_2cc2538_2clock_8c_source.html">clock.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga50c22f9b9d60dd1f9e59b63a3a6676b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CCIF clock_time_t clock_time </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the current clock time. </p>
<p>This function returns the current system clock time.</p>
<dl class="section return"><dt>Returns</dt><dd>The current clock time, measured in system ticks. </dd></dl>

<p>Definition at line <a class="el" href="cpu_2cc2538_2clock_8c_source.html#l00118">118</a> of file <a class="el" href="cpu_2cc2538_2clock_8c_source.html">clock.c</a>.</p>

<p>Referenced by <a class="el" href="srf06-cc26xx_2sensortag_2button-sensor_8c_source.html#l00076">button_press_handler()</a>, <a class="el" href="platform_2jn516x_2dev_2clock_8c_source.html#l00250">clock_seconds()</a>, <a class="el" href="cpu_2cc2538_2clock_8c_source.html#l00136">clock_wait()</a>, <a class="el" href="nrf52dk_2dev_2button-sensor_8c_source.html#l00075">gpiote_event_handler()</a>, <a class="el" href="mac-sequence_8c_source.html#l00072">mac_sequence_is_duplicate()</a>, <a class="el" href="mac-sequence_8c_source.html#l00101">mac_sequence_register_seqno()</a>, <a class="el" href="rpl-lite_2rpl-dag_8c_source.html#l00231">rpl_dag_update_state()</a>, <a class="el" href="rpl-neighbor_8c_source.html#l00078">rpl_neighbor_print_list()</a>, <a class="el" href="cpu_2native_2rtimer-arch_8c_source.html#l00074">rtimer_arch_schedule()</a>, <a class="el" href="timer_8c_source.html#l00122">timer_expired()</a>, <a class="el" href="timer_8c_source.html#l00142">timer_remaining()</a>, <a class="el" href="timer_8c_source.html#l00105">timer_restart()</a>, and <a class="el" href="timer_8c_source.html#l00064">timer_set()</a>.</p>

</div>
</div>
<a class="anchor" id="ga82ef3aca786cc000eeece4a7d036b238"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clock_wait </td>
          <td>(</td>
          <td class="paramtype">clock_time_t&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Wait for a given number of ticks. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>How many ticks.</td></tr>
  </table>
  </dd>
</dl>
<p>Wait for a given number of ticks. </p>

<p>Definition at line <a class="el" href="cpu_2cc2538_2clock_8c_source.html#l00136">136</a> of file <a class="el" href="cpu_2cc2538_2clock_8c_source.html">clock.c</a>.</p>

<p>References <a class="el" href="cmsis__gcc_8h_source.html#l00394">__WFE()</a>, <a class="el" href="cpu_2cc2538_2clock_8c_source.html#l00118">clock_time()</a>, <a class="el" href="hdc-1000-sensor_8c_source.html#l00142">start()</a>, and <a class="el" href="cpu_2cc2538_2dev_2watchdog_8c_source.html#l00085">watchdog_periodic()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Oct 6 2017 14:29:34 for Contiki-NG by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
