<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Contiki-NG: SensorTag 2.0 Light Sensor</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doc-style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Contiki-NG
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">SensorTag 2.0 Light Sensor<div class="ingroups"><a class="el" href="a01268.html">Sensortag CC1350/CC2650 common</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Due to the time required for the sensor to startup, this driver is meant to be used in an asynchronous fashion.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:a00668"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00668.html">opt-3001-sensor.c</a></td></tr>
<tr class="memdesc:a00668"><td class="mdescLeft">&#160;</td><td class="mdescRight">Driver for the Sensortag Opt3001 light sensor. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00669"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00669.html">opt-3001-sensor.h</a></td></tr>
<tr class="memdesc:a00669"><td class="mdescLeft">&#160;</td><td class="mdescRight">Header file for the Sensortag Opt3001 light sensor. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga9a285fc2222081defbe3a867a18220d8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga9a285fc2222081defbe3a867a18220d8"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01275.html#ga9a285fc2222081defbe3a867a18220d8">select_on_bus</a> (void)</td></tr>
<tr class="memdesc:ga9a285fc2222081defbe3a867a18220d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Select the sensor on the I2C bus. <br/></td></tr>
<tr class="separator:ga9a285fc2222081defbe3a867a18220d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga930bd8c36cc06dbedb5ff2428d4ce972"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01275.html#ga930bd8c36cc06dbedb5ff2428d4ce972">enable_sensor</a> (bool enable)</td></tr>
<tr class="memdesc:ga930bd8c36cc06dbedb5ff2428d4ce972"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turn the sensor on/off.  <a href="#ga930bd8c36cc06dbedb5ff2428d4ce972">More...</a><br/></td></tr>
<tr class="separator:ga930bd8c36cc06dbedb5ff2428d4ce972"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9d682ef12a5bf5a1389abad7cdd0cbcf"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01275.html#ga9d682ef12a5bf5a1389abad7cdd0cbcf">read_data</a> (uint16_t *raw_data)</td></tr>
<tr class="memdesc:ga9d682ef12a5bf5a1389abad7cdd0cbcf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read the result register.  <a href="#ga9d682ef12a5bf5a1389abad7cdd0cbcf">More...</a><br/></td></tr>
<tr class="separator:ga9d682ef12a5bf5a1389abad7cdd0cbcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3a6757e7145fdc27a456091ca5d0dc75"><td class="memItemLeft" align="right" valign="top">static float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01275.html#ga3a6757e7145fdc27a456091ca5d0dc75">convert</a> (uint16_t raw_data)</td></tr>
<tr class="memdesc:ga3a6757e7145fdc27a456091ca5d0dc75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert raw data to a value in lux.  <a href="#ga3a6757e7145fdc27a456091ca5d0dc75">More...</a><br/></td></tr>
<tr class="separator:ga3a6757e7145fdc27a456091ca5d0dc75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga28fd6d73f5b6b5107142fb0c49ded60b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01275.html#ga28fd6d73f5b6b5107142fb0c49ded60b">value</a> (int type)</td></tr>
<tr class="memdesc:ga28fd6d73f5b6b5107142fb0c49ded60b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a reading from the sensor.  <a href="#ga28fd6d73f5b6b5107142fb0c49ded60b">More...</a><br/></td></tr>
<tr class="separator:ga28fd6d73f5b6b5107142fb0c49ded60b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae2988cd9db2a4fcb2976f4d6a9f64a24"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01275.html#gae2988cd9db2a4fcb2976f4d6a9f64a24">configure</a> (int type, int enable)</td></tr>
<tr class="memdesc:gae2988cd9db2a4fcb2976f4d6a9f64a24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configuration function for the OPT3001 sensor.  <a href="#gae2988cd9db2a4fcb2976f4d6a9f64a24">More...</a><br/></td></tr>
<tr class="separator:gae2988cd9db2a4fcb2976f4d6a9f64a24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7baafe833c070f7e1ffa9020bcd18a56"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a01275.html#ga7baafe833c070f7e1ffa9020bcd18a56">status</a> (int type)</td></tr>
<tr class="memdesc:ga7baafe833c070f7e1ffa9020bcd18a56"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the status of the sensor.  <a href="#ga7baafe833c070f7e1ffa9020bcd18a56">More...</a><br/></td></tr>
<tr class="separator:ga7baafe833c070f7e1ffa9020bcd18a56"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Due to the time required for the sensor to startup, this driver is meant to be used in an asynchronous fashion. </p>
<p>The caller must first activate the sensor by calling SENSORS_ACTIVATE(). This will trigger the sensor's startup sequence, but the call will not wait for it to complete so that the CPU can perform other tasks or drop to a low power mode.</p>
<p>Once the reading and conversion are complete, the driver will generate a sensors_changed event.</p>
<p>We use single-shot readings. In this mode, the hardware automatically goes back to its shutdown mode after the conversion is finished. However, it will still respond to I2C operations, so the last conversion can still be read out.</p>
<p>In order to take a new reading, the caller has to use SENSORS_ACTIVATE again. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gae2988cd9db2a4fcb2976f4d6a9f64a24"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int configure </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>enable</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Configuration function for the OPT3001 sensor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>Activate, enable or disable the sensor. See below </td></tr>
    <tr><td class="paramname">enable</td><td>When type == SENSORS_HW_INIT we turn on the hardware When type == SENSORS_ACTIVE and enable==1 we enable the sensor When type == SENSORS_ACTIVE and enable==0 we disable the sensor </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00668_source.html#l00278">278</a> of file <a class="el" href="a00668_source.html">opt-3001-sensor.c</a>.</p>

<p>References <a class="el" href="a01096_source.html#l00099">ctimer_set()</a>, <a class="el" href="a01096_source.html#l00149">ctimer_stop()</a>, and <a class="el" href="a00668_source.html#l00168">enable_sensor()</a>.</p>

</div>
</div>
<a class="anchor" id="ga3a6757e7145fdc27a456091ca5d0dc75"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static float convert </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>raw_data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Convert raw data to a value in lux. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">raw_data</td><td>data Pointer to a buffer with a raw sensor reading </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Converted value (lux) </dd></dl>

<p>Definition at line <a class="el" href="a00668_source.html#l00230">230</a> of file <a class="el" href="a00668_source.html">opt-3001-sensor.c</a>.</p>

<p>Referenced by <a class="el" href="a00668_source.html#l00246">value()</a>.</p>

</div>
</div>
<a class="anchor" id="ga930bd8c36cc06dbedb5ff2428d4ce972"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void enable_sensor </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>enable</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Turn the sensor on/off. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">enable</td><td>TRUE: on, FALSE: off </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="a00668_source.html#l00168">168</a> of file <a class="el" href="a00668_source.html">opt-3001-sensor.c</a>.</p>

<p>References <a class="el" href="a00668_source.html#l00135">select_on_bus()</a>, and <a class="el" href="a00672_source.html#l00054">sensor_common_write_reg()</a>.</p>

<p>Referenced by <a class="el" href="a00668_source.html#l00278">configure()</a>.</p>

</div>
</div>
<a class="anchor" id="ga9d682ef12a5bf5a1389abad7cdd0cbcf"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool read_data </td>
          <td>(</td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>raw_data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Read the result register. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">raw_data</td><td>Pointer to a buffer to store the reading </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE if valid data </dd></dl>

<p>Definition at line <a class="el" href="a00668_source.html#l00196">196</a> of file <a class="el" href="a00668_source.html">opt-3001-sensor.c</a>.</p>

<p>References <a class="el" href="a00668_source.html#l00135">select_on_bus()</a>, <a class="el" href="a00672_source.html#l00048">sensor_common_read_reg()</a>, and <a class="el" href="a00672_source.html#l00071">sensor_common_set_error_data()</a>.</p>

<p>Referenced by <a class="el" href="a00668_source.html#l00246">value()</a>.</p>

</div>
</div>
<a class="anchor" id="ga7baafe833c070f7e1ffa9020bcd18a56"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int status </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the status of the sensor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>ignored </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The state of the sensor SENSOR_STATE_xyz </dd></dl>

<p>Definition at line <a class="el" href="a00668_source.html#l00314">314</a> of file <a class="el" href="a00668_source.html">opt-3001-sensor.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga28fd6d73f5b6b5107142fb0c49ded60b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int value </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns a reading from the sensor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>Ignored </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Illuminance in centilux </dd></dl>

<p>Definition at line <a class="el" href="a00668_source.html#l00246">246</a> of file <a class="el" href="a00668_source.html">opt-3001-sensor.c</a>.</p>

<p>References <a class="el" href="a00668_source.html#l00230">convert()</a>, and <a class="el" href="a00668_source.html#l00196">read_data()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Oct 6 2017 14:06:49 for Contiki-NG by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
